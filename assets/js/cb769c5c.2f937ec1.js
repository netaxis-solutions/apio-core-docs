"use strict";(self.webpackChunkapio_core=self.webpackChunkapio_core||[]).push([[9235],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},p="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(n),d=a,f=p["".concat(l,".").concat(d)]||p[d]||h[d]||r;return n?o.createElement(f,s(s({ref:t},c),{},{components:n})):o.createElement(f,s({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,s=new Array(r);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:a,s[1]=i;for(var u=2;u<r;u++)s[u]=n[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},395:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>u});var o=n(7462),a=(n(7294),n(3905));const r={sidebar_position:2},s="Authentication",i={unversionedId:"auth",id:"auth",title:"Authentication",description:"APIO core supports multiple authentication mechanisms. You can use them to authenticate your users and to authenticate your API calls.",source:"@site/docs/auth.md",sourceDirName:".",slug:"/auth",permalink:"/apio-core-docs/docs/auth",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Welcome to APIO core engine",permalink:"/apio-core-docs/docs/intro"},next:{title:"Workflows",permalink:"/apio-core-docs/docs/category/workflows"}},l={},u=[{value:"Local users",id:"local-users",level:2},{value:"Broadsoft users",id:"broadsoft-users",level:3},{value:"Single Sign-On (SSO)",id:"single-sign-on-sso",level:2},{value:"Sequence for OIDC authentication",id:"sequence-for-oidc-authentication",level:3},{value:"API users",id:"api-users",level:2},{value:"Login API",id:"login-api",level:3},{value:"Response",id:"response",level:4},{value:"Response when the user has an M2M token set",id:"response-when-the-user-has-an-m2m-token-set",level:4},{value:"Response when Two-Factor Authentication is required from the user",id:"response-when-two-factor-authentication-is-required-from-the-user",level:4},{value:"Sequence for regular login",id:"sequence-for-regular-login",level:4},{value:"Sequence for login with 2FA required",id:"sequence-for-login-with-2fa-required",level:4},{value:"Refresh token",id:"refresh-token",level:3},{value:"Response",id:"response-1",level:4}],c={toc:u},p="wrapper";function h(e){let{components:t,...r}=e;return(0,a.kt)(p,(0,o.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"authentication"},"Authentication"),(0,a.kt)("p",null,"APIO core supports multiple authentication mechanisms. You can use them to authenticate your users and to authenticate your API calls."),(0,a.kt)("p",null,"At the end of each authentication process, the user gets a JWT token. The JWT token is used to authenticate the API calls by adding it to the ",(0,a.kt)("inlineCode",{parentName:"p"},"Authorization")," header (Bearer ",(0,a.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication"},"authentication scheme"),") of the HTTP requests."),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Refer to the ",(0,a.kt)("a",{parentName:"p",href:"configuration/sso"},"configuration documentation")," to configure the authentication mechanisms.")),(0,a.kt)("h2",{id:"local-users"},"Local users"),(0,a.kt)("p",null,"Local users are users that are stored in the database of the APIO core. They are the default users of the APIO core. They are used to authenticate the users of the APIO core UI and to authenticate the API calls."),(0,a.kt)("p",null,"On the login page, they use their username and password to authenticate."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Login page",src:n(6607).Z,width:"719",height:"447"})),(0,a.kt)("h3",{id:"broadsoft-users"},"Broadsoft users"),(0,a.kt)("p",null,"The Broadsoft platform can be integrated as IdP for the APIO core users. So, the users of the Broadsoft platform can be used as the users of the APIO core, using the same username and password."),(0,a.kt)("h2",{id:"single-sign-on-sso"},"Single Sign-On (SSO)"),(0,a.kt)("p",null,"APIO core supports SSO authentication using the ",(0,a.kt)("a",{parentName:"p",href:"https://openid.net/connect/"},"OpenID Connect")," and ",(0,a.kt)("a",{parentName:"p",href:"https://saml.org"},"SAML")," . It allows you to use your existing identity provider to authenticate your users in the APIO core."),(0,a.kt)("p",null,"On the login page, they use the button of the identity provider to authenticate."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Login page",src:n(3915).Z,width:"707",height:"513"})),(0,a.kt)("h3",{id:"sequence-for-oidc-authentication"},"Sequence for OIDC authentication"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"OIDC authentication sequence",src:n(1746).Z,width:"881",height:"391"})),(0,a.kt)("h2",{id:"api-users"},"API users"),(0,a.kt)("p",null,"API users are users that are stored in the database of the APIO core. They are used to authenticate the API calls."),(0,a.kt)("p",null,"The API users use the login API to collect the JWT tokens. The JWT tokens is used to authenticate the API calls."),(0,a.kt)("h3",{id:"login-api"},"Login API"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'POST /api/v01/auth/login HTTP/1.1\nHost: api.example.com\nContent-Type: application/json\n\n{\n  "username": "user",\n  "password": "password"\n}\n')),(0,a.kt)("h4",{id:"response"},"Response"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\n{\n    "access_token": "...",\n    "refresh_token": "..."\n}\n')),(0,a.kt)("h4",{id:"response-when-the-user-has-an-m2m-token-set"},"Response when the user has an M2M token set"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\n{\n    "access_token": "...",\n    "refresh_token": "...",\n    "token": "..."\n}\n')),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"The ",(0,a.kt)("inlineCode",{parentName:"p"},"token")," is the M2M token of the user. It is meant to be immutable and it can be used as the access token for the API calls.")),(0,a.kt)("h4",{id:"response-when-two-factor-authentication-is-required-from-the-user"},"Response when Two-Factor Authentication is required from the user"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\n{\n    "2fa_payload": "...",\n    "option": "email | totp"\n}\n')),(0,a.kt)("p",null,"Then the client is supposed to send the 2FA code to the 2FA API."),(0,a.kt)("h4",{id:"sequence-for-regular-login"},"Sequence for regular login"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Regular login sequence",src:n(2085).Z,width:"741",height:"201"})),(0,a.kt)("h4",{id:"sequence-for-login-with-2fa-required"},"Sequence for login with 2FA required"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"2FA login sequence",src:n(9440).Z,width:"751",height:"546"})),(0,a.kt)("h3",{id:"refresh-token"},"Refresh token"),(0,a.kt)("p",null,"The access token can be used to make API calls for a short period of time. After that, the access token expires and the client needs to use the refresh token to get a new access token."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},"GET /api/v01/auth/access_token HTTP/1.1\nHost: api.example.com\nAuthorization: Bearer <refresh_token>\n")),(0,a.kt)("h4",{id:"response-1"},"Response"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\n{\n    "access_token": "...",\n    "refresh_token": "..."\n}\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"A new refresh token is sent only when the refresh token is about to expire.")))}h.isMDXComponent=!0},9440:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/login-flow-2fa-b14e1b73cf51bba948f1eca833c29d01.png"},1746:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/login-flow-oidc-b742f73b7d1d519f51bee935c14d8faa.png"},2085:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/login-flow-regular-b0f8680a10e0f9381512018fafeb8a04.png"},6607:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/login-no-sso-9357ed7cf0a6f72fb5e63a4118e7e2e1.png"},3915:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/login-with-google-34bd2222b04a053fd5ff97d87eb132ba.png"}}]);